<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Prometheus ì™œ promethues Operatorë¥¼ ì‚¬ìš©í–ˆì„ê¹Œ? PrometheusëŠ” ë‹¤ì–‘í•œ ëŒ€ìƒ(target)ì—ì„œ ì‹œê°„ ê²½ê³¼ì— ë”°ë¥¸ ì§€í‘œë¥¼ ìˆ˜ì§‘í•˜ì—¬ ì €ì¥í•˜ëŠ” ì‹œê³„ì—´ ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°ì´í„°ë¥¼ ìš°ë¦¬ ëˆˆì— ì‰½ê²Œ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ Grafanaì…ë‹ˆë‹¤.\n"><title>HexaCTF 9. Challenge Operator ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ì„¤ì • ë° Prometheus Operatorì™€ ì—°ê²°í•˜ê¸°</title>
<link rel=canonical href=https://s0okju.github.io/p/hexactf-9/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="HexaCTF 9. Challenge Operator ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ì„¤ì • ë° Prometheus Operatorì™€ ì—°ê²°í•˜ê¸°"><meta property='og:description' content="Prometheus ì™œ promethues Operatorë¥¼ ì‚¬ìš©í–ˆì„ê¹Œ? PrometheusëŠ” ë‹¤ì–‘í•œ ëŒ€ìƒ(target)ì—ì„œ ì‹œê°„ ê²½ê³¼ì— ë”°ë¥¸ ì§€í‘œë¥¼ ìˆ˜ì§‘í•˜ì—¬ ì €ì¥í•˜ëŠ” ì‹œê³„ì—´ ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°ì´í„°ë¥¼ ìš°ë¦¬ ëˆˆì— ì‰½ê²Œ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ Grafanaì…ë‹ˆë‹¤.\n"><meta property='og:url' content='https://s0okju.github.io/p/hexactf-9/'><meta property='og:site_name' content='S0okJu.dev'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Kubernetes'><meta property='article:tag' content='Prometheus'><meta property='article:tag' content='Grafana'><meta property='article:published_time' content='2025-03-07T00:00:00+09:00'><meta property='article:modified_time' content='2025-03-07T00:00:00+09:00'><meta name=twitter:title content="HexaCTF 9. Challenge Operator ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ì„¤ì • ë° Prometheus Operatorì™€ ì—°ê²°í•˜ê¸°"><meta name=twitter:description content="Prometheus ì™œ promethues Operatorë¥¼ ì‚¬ìš©í–ˆì„ê¹Œ? PrometheusëŠ” ë‹¤ì–‘í•œ ëŒ€ìƒ(target)ì—ì„œ ì‹œê°„ ê²½ê³¼ì— ë”°ë¥¸ ì§€í‘œë¥¼ ìˆ˜ì§‘í•˜ì—¬ ì €ì¥í•˜ëŠ” ì‹œê³„ì—´ ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°ì´í„°ë¥¼ ìš°ë¦¬ ëˆˆì— ì‰½ê²Œ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ Grafanaì…ë‹ˆë‹¤.\n"><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c3a763b4e1e1539a.png width=300 height=248 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ‘¾</span></figure><div class=site-meta><h1 class=site-name><a href=/>S0okJu.dev</a></h1><h2 class=site-description>ê²½í—˜ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤.</h2></div></header><ol class=menu-social><li><a href=https://github.com/S0okJu target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#prometheus>Prometheus</a><ol><li><a href=#ì™œ-promethues-operatorë¥¼-ì‚¬ìš©í–ˆì„ê¹Œ>ì™œ promethues Operatorë¥¼ ì‚¬ìš©í–ˆì„ê¹Œ?</a></li></ol></li><li><a href=#challenge-ìƒíƒœë¥¼-ë‚˜íƒ€ë‚´ëŠ”-ì»¤ìŠ¤í…€-ë©”íŠ¸ë¦­-ì œì‘í•˜ê¸°>Challenge ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ì œì‘í•˜ê¸°</a><ol><li><a href=#challenge-ìƒíƒœ-ì •ë³´-ë©”íŠ¸ë¦­ì˜-íŠ¹ì§•>Challenge ìƒíƒœ ì •ë³´ ë©”íŠ¸ë¦­ì˜ íŠ¹ì§•</a><ol><li></li><li><a href=#challenge-ì‚¬ìš©-íŒ¨í„´-í™•ì¸>Challenge ì‚¬ìš© íŒ¨í„´ í™•ì¸</a></li></ol></li><li><a href=#ì–´ë–¤-ë©”íŠ¸ë¦­ì„-í™œìš©í• ê¹Œ>ì–´ë–¤ ë©”íŠ¸ë¦­ì„ í™œìš©í• ê¹Œ</a><ol><li><a href=#ì„ íƒ-ê¸°ì¤€ì€>ì„ íƒ ê¸°ì¤€ì€?</a></li></ol></li><li><a href=#labelì€-ì–´ë–»ê²Œ-ì„¤ì •í• ê¹Œ>Labelì€ ì–´ë–»ê²Œ ì„¤ì •í• ê¹Œ?</a></li><li><a href=#ì¶”ê°€-deleted-ìƒíƒœ-ì •ë³´ëŠ”-ì–¸ì œê¹Œì§€-ê°€ì§€ê³ -ìˆì–´ì•¼-í• ê¹Œ>ì¶”ê°€: Deleted ìƒíƒœ ì •ë³´ëŠ” ì–¸ì œê¹Œì§€ ê°€ì§€ê³  ìˆì–´ì•¼ í• ê¹Œ?</a></li></ol></li><li><a href=#challenge-operator-ì¿ ë²„ë„¤í‹°ìŠ¤ì—-ë°°í¬í•˜ê¸°>Challenge Operator ì¿ ë²„ë„¤í‹°ìŠ¤ì— ë°°í¬í•˜ê¸°</a><ol><li><a href=#metrics-endpoint-ì„¤ì •>metrics endpoint ì„¤ì •</a></li><li><a href=#helm-ìœ¼ë¡œ-ë°°í¬í•˜ê¸°>Helm ìœ¼ë¡œ ë°°í¬í•˜ê¸°</a></li><li><a href=#servicemonitor-ì„¤ì •í•˜ê¸°>ServiceMonitor ì„¤ì •í•˜ê¸°</a></li></ol></li><li><a href=#ì‹œê°í™”>ì‹œê°í™”</a><ol><li><a href=#ìƒíƒœë³„-challenge-ê°œìˆ˜>ìƒíƒœë³„ Challenge ê°œìˆ˜</a></li><li><a href=#ì‚¬ìš©ì-ë¬¸ì œ-ë³„-challenge-ìƒíƒœ>ì‚¬ìš©ì, ë¬¸ì œ ë³„ Challenge ìƒíƒœ</a></li></ol></li><li><a href=#ë§ˆì¹˜ë©°>ë§ˆì¹˜ë©°</a></li><li><a href=#references>References</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/hexactf/>HexaCTF</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/hexactf-9/>HexaCTF 9. Challenge Operator ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ì„¤ì • ë° Prometheus Operatorì™€ ì—°ê²°í•˜ê¸°</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 07, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>9 minute read</time></div></footer></div></header><section class=article-content><h2 id=prometheus>Prometheus</h2><h3 id=ì™œ-promethues-operatorë¥¼-ì‚¬ìš©í–ˆì„ê¹Œ>ì™œ promethues Operatorë¥¼ ì‚¬ìš©í–ˆì„ê¹Œ?</h3><p>PrometheusëŠ” ë‹¤ì–‘í•œ ëŒ€ìƒ(target)ì—ì„œ ì‹œê°„ ê²½ê³¼ì— ë”°ë¥¸ ì§€í‘œë¥¼ ìˆ˜ì§‘í•˜ì—¬ ì €ì¥í•˜ëŠ” ì‹œê³„ì—´ ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°ì´í„°ë¥¼ ìš°ë¦¬ ëˆˆì— ì‰½ê²Œ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ Grafanaì…ë‹ˆë‹¤.</p><blockquote><p>í”„ë¡œë©”í…Œìš°ìŠ¤ ì‹¤í–‰ ì ˆì°¨ëŠ” <a class=link href=https://wlsdn3004.tistory.com/35 target=_blank rel=noopener>wlsdn3004ë‹˜ì˜ Prometheus ë€?</a>ë¥¼ ì°¸ê³ í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.</p></blockquote><p>ì—¬ê¸°ì„œ ë‹¨ìˆœí•œ ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ì•„ë‹Œ ì¿ ë²„ë„¤í‹°ìŠ¤ ì˜¤í¼ë ˆì´í„°ë¥¼ í™œìš©í•œ ì´ìœ ëŠ” ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ë¥¼ í†µí•´ ë©€í‹° í´ëŸ¬ìŠ¤í„° í˜¹ì€ ë‹¤ë¥¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ í™˜ê²½ì— ëŒ€ì‘í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.<br>ì—¬ê¸°ì„œ ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ì•¼ê² ì£ ? ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°(ServiceMonitor)ëŠ” ë™ì ìœ¼ë¡œ ë‹¤ìˆ˜ ì„œë¹„ìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì„ ì–¸ì ìœ¼ë¡œ ì •ì˜í•œ ê²ƒì…ë‹ˆë‹¤. ì›í•˜ëŠ” êµ¬ì„±ìœ¼ë¡œ ServiceMonitorë¥¼ ì ìš©ì‹œí‚¤ë©´ Prometheus OperatorëŠ” ìë™ìœ¼ë¡œ ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë¥¼ ì°¾ê²Œ ë©ë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image.png width=798 height=355 srcset="/p/hexactf-9/image_hu_fdd2ca4f2b5427d9.png 480w, /p/hexactf-9/image_hu_326563f517b9604c.png 1024w" loading=lazy alt="ì¶œì²˜ - Prometheus Operator Architecture. Source:Â  www.nicktriller.com" class=gallery-image data-flex-grow=224 data-flex-basis=539px></p><p>ì œê°€ Prometheus Operatorë¥¼ ì“°ëŠ” ì´ìœ ëŠ” <strong>ë‹¤ë¥¸ Namespaceì— ìˆëŠ” Challenge Operatorì˜ ë©”íŠ¸ë¦­ ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•´ì„œì…ë‹ˆë‹¤.</strong> êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–»ê²Œ ì„¤ì •í• ì§€ëŠ” ì•„ë˜ì—ì„œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image-1.png width=972 height=677 srcset="/p/hexactf-9/image-1_hu_35953a980b95830c.png 480w, /p/hexactf-9/image-1_hu_973d19064e74c360.png 1024w" loading=lazy alt="ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë”°ë¥¸ í”„ë¡œì íŠ¸ êµ¬ì„±ë„" class=gallery-image data-flex-grow=143 data-flex-basis=344px></p><h2 id=challenge-ìƒíƒœë¥¼-ë‚˜íƒ€ë‚´ëŠ”-ì»¤ìŠ¤í…€-ë©”íŠ¸ë¦­-ì œì‘í•˜ê¸°>Challenge ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ì œì‘í•˜ê¸°</h2><h3 id=challenge-ìƒíƒœ-ì •ë³´-ë©”íŠ¸ë¦­ì˜-íŠ¹ì§•>Challenge ìƒíƒœ ì •ë³´ ë©”íŠ¸ë¦­ì˜ íŠ¹ì§•</h3><h5 id=ë¹ ë¥¸-ë¬¸ì œ-í•´ê²°>ë¹ ë¥¸ ë¬¸ì œ í•´ê²°</h5><p>í˜„ì¬ ì €í¬ ëŒ€íšŒì—ì„œ í•„ìš”í•œ ê²ƒì€ Challenge ì„±ëŠ¥ ì •ë³´ë³´ë‹¤ <strong>ìƒíƒœ ì •ë³´</strong>ì…ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ë¬¸ì œ ë°œìƒ ì‹œ ë¹ ë¥´ê²Œ ëŒ€ì²˜í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p><p>ì—¬ê¸°ì„œ Challenge ë‚´ì— ìˆëŠ” Deploymentì— ëŒ€í•´ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤. í•´í‚¹ ë¬¸ì œì˜ ê²½ìš° ì·¨ì•½í•œ í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì—¬ ë°°í¬í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰, ëª¨ë“  í”„ë¡œê·¸ë¨ ìì²´ê°€ ë‹¨ìˆœí•©ë‹ˆë‹¤. ë˜í•œ í•œ ì‚¬ëŒë‹¹ í•˜ë‚˜ì˜ Challengeë§Œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— íŠ¸ë˜í”½ ë¬¸ì œê°€ ë°œìƒí•  í™•ë¥ ì€ ë†’ìŠµë‹ˆë‹¤.</p><blockquote><p>íŠ¸ë˜í”½ í•­ìƒ ë‚®ê²Œ ì¸¡ì •ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°„í˜¹ Brute Force íŠ¹ì§•ì„ ê°€ì§„ í•´í‚¹ ë„êµ¬ë¥¼ í™œìš©í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ í–‰ë™ì€ ë¶€ì • í–‰ìœ„ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.</p></blockquote><p>ì—¬ê¸°ì„œ ë§í•˜ëŠ” ë¬¸ì œëŠ” <strong>ì„œë²„ ìƒì„± ì‹¤íŒ¨, ì„œë²„ ì‚­ì œ ì‹¤íŒ¨ ë“± ì˜¤í¼ë ˆì´í„°ì— ë°œìƒí•˜ëŠ” ë¬¸ì œ</strong>ë¥¼ ë§í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë¹ˆë²ˆí•˜ëŠ” ì•„ë‹ˆì§€ë§Œ ë“œë¬¼ê²Œ ì‚­ì œê°€ ì‹¤íŒ¨ë˜ëŠ” ê²½ìš°ê°€ ìˆì–´ì„œ Challenge ìƒíƒœ ì •ë³´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì‹œê°í™”ë¥¼ í–ˆìŠµë‹ˆë‹¤. ë§Œì•½ì— ì‚­ì œê°€ ì‹¤íŒ¨ë˜ì—ˆëŠ”ë° ì‹¤í–‰ ì¤‘ì´ë¼ë©´ ë‚¨ì•„ ìˆëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒì´ ìš°ì„ ì´ê² ì£ ?</p><p>ì¢€ ë” ìì„¸í•˜ê²Œ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒíƒœ ë©”íŠ¸ë¦­ë¿ë§Œ ì•„ë‹ˆë¼ ë¡œê¹…ê³¼ ë‹¤ë¥¸ ë©”íŠ¸ë¦­ì„ ì¡°í•©í•´ì„œ êµ¬í˜„í•´ì•¼ í•  ê²ƒ ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹œê°„ ê´€ê³„ ìƒ êµ¬í˜„í•˜ì§€ ëª»í–ˆìœ¼ë©° ì¶”í›„ êµ¬í˜„í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p><h4 id=challenge-ì‚¬ìš©-íŒ¨í„´-í™•ì¸>Challenge ì‚¬ìš© íŒ¨í„´ í™•ì¸</h4><p>ì œê°€ ìƒíƒœ ì •ë³´ë¥¼ ìš°ì„  ì œì‘í•œ ì´ìœ ì´ê¸°ë„ í•©ë‹ˆë‹¤.</p><p>ëŒ€íšŒ ì´ì „ì—ëŠ” 2ê°€ì§€ ê¶ê¸ˆì¦ì„ ê°€ì§€ê³  ìˆì—ˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì§ˆë¬¸ë“¤ì€ ì„œë²„ ë©”ëª¨ë¦¬ ìš©ëŸ‰ì„ ì‚°ì •í• ë•Œ í•„ìš”í•©ë‹ˆë‹¤.</p><ol><li>ì‚¬ëŒë“¤ì€ í•œë²ˆì— ëª‡ê°œì˜ ì„œë²„ë¥¼ ë§Œë“¤ê³  ë°©ì¹˜í• ê¹Œ? -> í•œ ì‚¬ëŒë‹¹ ìµœëŒ€ ëª‡ê°œì˜ ì„œë²„</li><li>ë¬¸ì œ ë¶„ì•¼ë§ˆë‹¤ í‘¸ëŠ” íŒ¨í„´ì´ ìˆì„ê¹Œ? -> Challenge ë¦¬ì†ŒìŠ¤ ì–‘ê³¼ ë¶„ì•¼ ë³„ ë¹„ìœ¨</li></ol><p>ì‚¬ìš© íŒ¨í„´ì€ í˜„ì¬ë³´ë‹¤ëŠ” ë¯¸ë˜ë¥¼ ìœ„í•œ ë©”íŠ¸ë¦­ ì§€í‘œë¼ê³  ë³´ë©´ ë©ë‹ˆë‹¤.</p><blockquote><p><strong>ì—¬ë‹´</strong>
ê¸€ ì‘ì„± ì‹œì ìœ¼ë¡œ ëŒ€íšŒë¥¼ ì„±ê³µì ìœ¼ë¡œ ë§ˆë¬´ë¦¬í–ˆìŠµë‹ˆë‹¤. ì‚¬ìš©ì íŒ¨í„´ì— ëŒ€í•´ì„œëŠ” ë‹¤ë¥¸ ê¸€ì—ì„œ ëµ™ê² ìŠµë‹ˆë‹¤.</p></blockquote><h3 id=ì–´ë–¤-ë©”íŠ¸ë¦­ì„-í™œìš©í• ê¹Œ>ì–´ë–¤ ë©”íŠ¸ë¦­ì„ í™œìš©í• ê¹Œ</h3><p><a class=link href=https://prometheus.io/docs/concepts/metric_types/ target=_blank rel=noopener>Prometheus ê³µì‹ ë¬¸ì„œ</a>ì— ì˜í•˜ë©´ ë©”íŠ¸ë¦­ì€ 4ê°œê°€ ìˆìŠµë‹ˆë‹¤.</p><ul><li>Guage: ì„ì˜ë¡œ ì˜¬ë¼ê°€ê±°ë‚˜ ë‚´ë ¤ê°ˆ ìˆ˜ ìˆëŠ” ë‹¨ì¼ ìˆ«ìê°’ì„ ë‚˜íƒ€ë‚´ëŠ ë©”íŠ¸ë¦­</li><li>Counter : ëˆ„ì ë˜ëŠ” ë©”íŠ¸ë¦­ ê°’. ê°ì†Œê°€ ì—†ìŒ</li><li>Histogram :ì§€ì—° ì‹œê°„, ì²˜ë¦¬ì‹œê°„ê³¼ ê°™ì´ ì—°ì†í˜• ê°’ì„ ë‹¤ë£°ë•Œ ì‚¬ìš©</li><li>Summary : ì—°ì†ì ì¸ ë°ì´í„° ê°’ì˜ ë¶„í¬ë¥¼ ì¸¡ì •</li></ul><h4 id=ì„ íƒ-ê¸°ì¤€ì€>ì„ íƒ ê¸°ì¤€ì€?</h4><p>ì €ëŠ” ìµœì¢…ì ìœ¼ë¡œ <strong>Gauge</strong>ë¥¼ ì„ íƒí•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p><ul><li>nì‹œê°„ ë§ˆë‹¤ ìˆ˜ì§‘ë˜ì–´ì•¼ í•¨</li><li>Running, Deleted, Error ê°œìˆ˜ì˜ ì¦ê°ì„ í‘œí˜„í•  ìˆ˜ ìˆì–´ì•¼ í•¨</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>crStatusMetric</span> <span class=p>=</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>NewGaugeVec</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>prometheus</span><span class=p>.</span><span class=nx>GaugeOpts</span><span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;challenge_resource_status&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>Help</span><span class=p>:</span> <span class=s>&#34;Tracks the status of the custom resource&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;challeng_id&#34;</span><span class=p>,</span> <span class=s>&#34;challenge_name&#34;</span><span class=p>,</span> <span class=s>&#34;username&#34;</span><span class=p>,</span> <span class=s>&#34;namespace&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>metrics</span><span class=p>.</span><span class=nx>Registry</span><span class=p>.</span><span class=nf>MustRegister</span><span class=p>(</span><span class=nx>crStatusMetric</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=labelì€-ì–´ë–»ê²Œ-ì„¤ì •í• ê¹Œ>Labelì€ ì–´ë–»ê²Œ ì„¤ì •í• ê¹Œ?</h3><p>Prometheusì˜ Labelì€ í‚¤-ê°’ ìŒìœ¼ë¡œ ì´ë¤„ì ¸ ìˆìœ¼ë©°, Proemtheusê°€ ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ì‹ë³„í•˜ëŠ”ë° ë©”íŠ¸ë¦­ ì´ë¦„ê³¼ ë”ë¶ˆì–´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><p>ì œê°€ ì›í•˜ëŠ” ìƒíƒœ ì •ë³´ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ ì…ë‹ˆë‹¤. ì œê°€ ìœ„í•´ì„œ ë§í•œ 2ê°€ì§€ ëª©ì ì— ëŒ€ì…í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p><ul><li>ìƒíƒœë³„ Challenge ê°œìˆ˜<ul><li>ì „ì²´ Challenge í˜„í™©ì„ íŒŒì•…í•˜ê¸° ìœ„í•´</li></ul></li><li><strong>ì‚¬ìš©ì, ë¬¸ì œ ë³„</strong> Challenge ìƒíƒœ<ul><li>ì‚¬ìš©ì íŒ¨í„´ íŒŒì•…</li><li>Error ë¬¸ì œ ë°œìƒ ì‹œ ë¹ ë¥´ê²Œ ë¬¸ì œë¥¼ ëŒ€ì²˜í•˜ê¸° ìœ„í•´</li></ul></li><li>ë¬¸ì œë³„ ì‹¤í–‰ ì¤‘/ì—ëŸ¬ ì»¤ìŠ¤í…€ ë¦¬ì†ŒìŠ¤ ìˆ˜<ul><li>ì‚¬ìš©ì íŒ¨í„´ íŒŒì•…</li><li>ì˜¤ë¥˜ ì‚¬í•­ì´ ìˆëŠ” Challengeë¥¼ ì°¾ê¸° ìœ„í•´</li></ul></li></ul><p>ê·¸ë ‡ë‹¤ë©´ Labelë¡œ ë¬´ì¡°ê±´ ì§€ì •í•  ê²ƒì€ <strong>ì‚¬ìš©ì ì‹ë³„ì, ë¬¸ì œ ì‹ë³„ì</strong>ì…ë‹ˆë‹¤. ì´ ë‘ê°€ì§€ë¥¼ í¬í•¨í•˜ì—¬ Challenge ì´ë¦„ê³¼ Namespaceë„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.</p><blockquote><p>ë³¸ë˜ ì¢…ë¥˜ì— ë”°ë¼ Namespaceë¥¼ ë¶„ë¦¬í•  ì˜ˆì •ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹œê°„ ê´€ê³„ ìƒ ëª»í•˜ê²Œ ë˜ì–´ ì½”ë“œì— ë‚¨ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p></blockquote><p>ê·¸ë¦¬ê³  ìƒíƒœ ì •ë³´ë¥¼ ê°’ìœ¼ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤. Gaugeì˜ íŠ¹ì§• ì¤‘ì— í•˜ë‚˜ëŠ” ê°’ì„ ì¦ê°í•  ìˆ˜ ìˆë‹¤ê³  í–ˆì£ ? ì´ ê¸°ëŠ¥ì„ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p><ul><li>Running: 1</li><li>Deleted: 2</li><li>Error: 3</li></ul><p>ì‹¤ì œ ì½”ë“œë¡œ ì‘ì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>crStatusMetric</span> <span class=p>=</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>NewGaugeVec</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>prometheus</span><span class=p>.</span><span class=nx>GaugeOpts</span><span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;challenge_resource_status&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>Help</span><span class=p>:</span> <span class=s>&#34;Tracks the status of the custom resource&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;challeng_id&#34;</span><span class=p>,</span> <span class=s>&#34;challenge_name&#34;</span><span class=p>,</span> <span class=s>&#34;username&#34;</span><span class=p>,</span> <span class=s>&#34;namespace&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>metrics</span><span class=p>.</span><span class=nx>Registry</span><span class=p>.</span><span class=nf>MustRegister</span><span class=p>(</span><span class=nx>crStatusMetric</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ...</span>
</span></span><span class=line><span class=cl><span class=nx>crStatusMetric</span><span class=p>.</span><span class=nf>WithLabelValues</span><span class=p>(</span><span class=nx>challenge</span><span class=p>.</span><span class=nx>Labels</span><span class=p>[</span><span class=s>&#34;apps.hexactf.io/challengeId&#34;</span><span class=p>],</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Labels</span><span class=p>[</span><span class=s>&#34;apps.hexactf.io/user&#34;</span><span class=p>],</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Namespace</span><span class=p>).</span><span class=nf>Set</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ì¶”ê°€-deleted-ìƒíƒœ-ì •ë³´ëŠ”-ì–¸ì œê¹Œì§€-ê°€ì§€ê³ -ìˆì–´ì•¼-í• ê¹Œ>ì¶”ê°€: Deleted ìƒíƒœ ì •ë³´ëŠ” ì–¸ì œê¹Œì§€ ê°€ì§€ê³  ìˆì–´ì•¼ í• ê¹Œ?</h3><p>ë©”íŠ¸ë¦­ êµ¬í˜„ ë¶€ë¶„ì—ì„œ &ldquo;Deleted ìƒíƒœ ì •ë³´ëŠ” ì–¸ì œê¹Œì§€ ê°€ì§€ê³  ìˆì–´ì•¼ í• ê¹Œ?&ldquo;ê°€ ë‚œì œì´ì§€ ì•Šì„ê¹Œ ì‹¶ìŠµë‹ˆë‹¤.<br>PromethuesëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 30ì´ˆ ê°„ê²©ìœ¼ë¡œ <code>/metrics</code> ë‚´ìš©ì„ ìŠ¤í¬ë©í•©ë‹ˆë‹¤.</p><p>ì €ì—ê²ŒëŠ” ë‘ ê°€ì§€ ê³ ë¯¼ì´ ìˆì—ˆìŠµë‹ˆë‹¤.</p><ol><li>ì‚­ì œ ìš”ì²­ ì‹œ ë©”íŠ¸ë¦­ì„ Deleted(3)ë¡œ ì„¤ì • -> <code>/metrics</code>ì— ë¶ˆí•„ìš”í•œ ë°ì´í„°ê°€ ìŒ“ì„. ëŒ€íšŒê°€ ëë‚ ë•Œë§ˆë‹¤ ì£¼ê¸°ì ìœ¼ë¡œ ì‚­ì œí•˜ëŠ” ì‘ì—…ì´ í•„ìš”</li><li>ì‚­ì œ ìš”ì²­ ì‹œ ë©”íŠ¸ë¦­ì„ Deleted ìƒíƒœë¡œ ë³€ê²½ í›„ <strong>ì¦‰ì‹œ ì‚­ì œ</strong> -> Prometheusê°€ Deleted ìƒíƒœë¥¼ ìŠ¤í¬ë©í•  ìˆ˜ ìˆë„ë¡ ì‹œê°„ ì¡°ì •ì´ í•„ìš”</li></ol><p>ëŒ€íšŒ ì‹œê¸°ì—ëŠ” Running, Errorë¥¼ ì¤‘ì ì ìœ¼ë¡œ ë³¼ ì˜ˆì •ì´ê¸° ë•Œë¬¸ì— <strong>ë‘ ë²ˆì§¸ ë°©ë²•</strong>ì„ ì„ íƒí•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.<br>ë‹¤ë§Œ Prometheusê°€ Deleted ìƒíƒœë¥¼ í•œë²ˆ ìŠ¤í¬ë©í•˜ê³  ì‚­ì œë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— <strong>ê³ ë£¨í‹´ì„ í™œìš©í•˜ì—¬ 1ë¶„ í›„ì— ë©”íŠ¸ë¦­ì´ ì‚­ì œë  ìˆ˜ ìˆë„ë¡ êµ¬í˜„</strong>í–ˆìŠµë‹ˆë‹¤.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>r</span> <span class=o>*</span><span class=nx>ChallengeReconciler</span><span class=p>)</span> <span class=nf>handleDeletion</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>challenge</span> <span class=o>*</span><span class=nx>hexactfproj</span><span class=p>.</span><span class=nx>Challenge</span><span class=p>)</span> <span class=p>(</span><span class=nx>ctrl</span><span class=p>.</span><span class=nx>Result</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>log</span><span class=p>.</span><span class=nf>Info</span><span class=p>(</span><span class=s>&#34;Processing deletion&#34;</span><span class=p>,</span> <span class=s>&#34;challenge&#34;</span><span class=p>,</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>crStatusMetric</span><span class=p>.</span><span class=nf>WithLabelValues</span><span class=p>(</span><span class=nx>challenge</span><span class=p>.</span><span class=nx>Labels</span><span class=p>[</span><span class=s>&#34;apps.hexactf.io/challengeId&#34;</span><span class=p>],</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Labels</span><span class=p>[</span><span class=s>&#34;apps.hexactf.io/user&#34;</span><span class=p>],</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Namespace</span><span class=p>).</span><span class=nf>Set</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// ...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>1</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Minute</span><span class=p>)</span> <span class=c1>// scrape_intervalì´ 30ì´ˆë¼ë©´ 1ë¶„ ì •ë„ ê¸°ë‹¤ë¦¬ë©´ ì•ˆì „</span>
</span></span><span class=line><span class=cl>		<span class=nx>crStatusMetric</span><span class=p>.</span><span class=nf>DeleteLabelValues</span><span class=p>(</span><span class=nx>challenge</span><span class=p>.</span><span class=nx>Labels</span><span class=p>[</span><span class=s>&#34;apps.hexactf.io/challengeId&#34;</span><span class=p>],</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Labels</span><span class=p>[</span><span class=s>&#34;apps.hexactf.io/user&#34;</span><span class=p>],</span> <span class=nx>challenge</span><span class=p>.</span><span class=nx>Namespace</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl>	<span class=nx>log</span><span class=p>.</span><span class=nf>Info</span><span class=p>(</span><span class=s>&#34;Successfully completed deletion process&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1>// ì´ ì‹œì ì—ì„œ finalizersê°€ ë¹„ì–´ ìˆìœ¼ë¯€ë¡œ, K8sê°€ ì˜¤ë¸Œì íŠ¸ë¥¼ ì‹¤ì œ ì‚­ì œí•¨</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>ctrl</span><span class=p>.</span><span class=nx>Result</span><span class=p>{},</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=challenge-operator-ì¿ ë²„ë„¤í‹°ìŠ¤ì—-ë°°í¬í•˜ê¸°>Challenge Operator ì¿ ë²„ë„¤í‹°ìŠ¤ì— ë°°í¬í•˜ê¸°</h2><h3 id=metrics-endpoint-ì„¤ì •>metrics endpoint ì„¤ì •</h3><p>kubebuilderëŠ” CNCF í”„ë¡œì íŠ¸ì¸ë§Œí¼ <a class=link href=https://book.kubebuilder.io/reference/metrics target=_blank rel=noopener>í”„ë¡œë©”í…Œìš°ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ê°œë°©í•  ìˆ˜ ìˆëŠ” ServiceMonitorë¥¼ ìë™ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</a> ë‹¨, <strong>kubebuilderì— ë‚´ì¥ë˜ì–´ ìˆëŠ” kustomizeë¥¼ í™œìš©í•´ì•¼ ê°„ë‹¨í•œ ì„¤ì •ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</strong> ê·¸ëŸ¬ë‚˜ ì €ëŠ” kustomizeë¥¼ í™œìš©í•˜ì§€ ì•Šì„ ì˜ˆì •ì´ë¯€ë¡œ ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ì•„ë´ì•¼ í•©ë‹ˆë‹¤.</p><p>kustomizeëŠ” ë°°í¬ ë„êµ¬ì¼ë¿ ê·¼ë³¸ì ìœ¼ë¡œ kubebuilderì—ëŠ” ë©”íŠ¸ë¦­ì„ export í•´ì¤„ ìˆ˜ ìˆëŠ” í•¨ìˆ˜ê°€ ìˆë‹¤ê³  ìƒê°í•´ë„ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.<br><code>main.go</code> ì— ê°€ë³´ì‹œë©´ metricServerì˜ ì†ì„±ì„ í”„ë¡œê·¸ë¨ ì†ì„± ê°’ìœ¼ë¡œ ë°›ì•„ì„œ ì„¤ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì¦‰ í”„ë¡œê·¸ë¨ ì‹¤í–‰ì‹œí‚¬ë•Œ ì ì ˆí•œ ì†ì„±ê°’ì„ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>metricsAddr</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>enableLeaderElection</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>probeAddr</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>secureMetrics</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>enableHTTP2</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>tlsOpts</span> <span class=p>[]</span><span class=kd>func</span><span class=p>(</span><span class=o>*</span><span class=nx>tls</span><span class=p>.</span><span class=nx>Config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>metricsAddr</span><span class=p>,</span> <span class=s>&#34;metrics-bind-address&#34;</span><span class=p>,</span> <span class=s>&#34;:8080&#34;</span><span class=p>,</span> <span class=s>&#34;The address the metrics endpoint binds to. &#34;</span><span class=o>+</span>
</span></span><span class=line><span class=cl>		<span class=s>&#34;Use :8443 for HTTPS or :8080 for HTTP, or leave as 0 to disable the metrics service.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>probeAddr</span><span class=p>,</span> <span class=s>&#34;health-probe-bind-address&#34;</span><span class=p>,</span> <span class=s>&#34;:8081&#34;</span><span class=p>,</span> <span class=s>&#34;The address the probe endpoint binds to.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>BoolVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>enableLeaderElection</span><span class=p>,</span> <span class=s>&#34;leader-elect&#34;</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s>&#34;Enable leader election for controller manager. &#34;</span><span class=o>+</span>
</span></span><span class=line><span class=cl>			<span class=s>&#34;Enabling this will ensure there is only one active controller manager.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Prometheus metrics http ì‚¬ìš©</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>BoolVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>secureMetrics</span><span class=p>,</span> <span class=s>&#34;metrics-secure&#34;</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s>&#34;If set, the metrics endpoint is served securely via HTTPS. Use --metrics-secure=false to use HTTP instead.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>BoolVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>enableHTTP2</span><span class=p>,</span> <span class=s>&#34;enable-http2&#34;</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s>&#34;If set, HTTP/2 will be enabled for the metrics and webhook servers&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>opts</span> <span class=o>:=</span> <span class=nx>zap</span><span class=p>.</span><span class=nx>Options</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Development</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>opts</span><span class=p>.</span><span class=nf>BindFlags</span><span class=p>(</span><span class=nx>flag</span><span class=p>.</span><span class=nx>CommandLine</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ...</span>
</span></span><span class=line><span class=cl>	<span class=nx>metricsServerOptions</span> <span class=o>:=</span> <span class=nx>metricsserver</span><span class=p>.</span><span class=nx>Options</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>BindAddress</span><span class=p>:</span>   <span class=nx>metricsAddr</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>SecureServing</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=helm-ìœ¼ë¡œ-ë°°í¬í•˜ê¸°>Helm ìœ¼ë¡œ ë°°í¬í•˜ê¸°</h3><p>ìœ„ì˜ ê¸€ì—ì„œ Kustomizeë¥¼ í™œìš©í•˜ì§€ ì•Šì„ ê²ƒì´ë¼ê³  ë§ì”€ ë“œë ¸ìŠµë‹ˆë‹¤. ì´ìœ ëŠ” ë‹¨ìˆœí•˜ê²Œ <strong>Helmì´ ê°€ì¥ ìµìˆ™</strong>í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.<br>ê·¸ë˜ë„ ì°¨ì´ì ì€ í™•ì¸í•´ë´ì•¼ê² ì£ ? <a class=link href=https://www.gomgomshrimp.com/posts/k8s/helm-and-kustomize target=_blank rel=noopener>SEOWOOë‹˜ì˜ ë¸”ë¡œê·¸ - Helmê³¼ Kustomize, ë¬´ì—‡ì„ ì“¸ê¹Œ?</a> ì¼ë¶€ ì°¸ê³ í•´ì„œ í•µì‹¬ì ì¸ ì°¨ì´ì ì„ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p><ul><li>Helm<ul><li>ì—¬ëŸ¬ í…œí”Œë¦¿ì˜ ëª¨ìŒìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë©° values.yamlì„ ë§¤ê°œë³€ìˆ˜í™”í•˜ì—¬ ê°’ì„ ì „ë‹¬</li><li>ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ íŒ¨í‚¤ì§€ ê´€ë¦¬ ë° ë°°í¬ì— ë” ì¤‘ì‹¬</li></ul></li><li>Kustomize<ul><li>ìƒì†ì˜ ê°œë…ì„ í™œìš©í•´ì„œ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì‘ì„±í•  ìˆ˜ ìˆìŒ</li><li>í™˜ê²½ë³„ ë°°í¬ êµ¬ì„± ê´€ë¦¬ì— ì í•©</li></ul></li></ul><p>Challenge Operatorë¥¼ ë°°í¬í• ë•Œ Deploymentë¥¼ í™œìš©í–ˆìŠµë‹ˆë‹¤. Operatorì˜ ì² í•™ì—ì„œë„ OperatorëŠ” ë‹¨ì¼ Deploymentë¡œ ë°°í¬ë˜ì–´ì•¼ í•œë‹¤ê³  ì„¤ëª…í–ˆìŠµë‹ˆë‹¤.</p><blockquote><ol><li>Operators should install as a single deployment e.g.Â <code>kubectl create -f https://coreos.com/operators/etcd/latest/deployment.yaml</code>Â and take no additional action once installed.</li></ol><ul><li>ì¶œì²˜: <a class=link href=https://www.redhat.com/en/blog/introducing-operators-putting-operational-knowledge-into-software target=_blank rel=noopener>Introducing Operators: Putting Operational Knowledge into Software</a></li></ul></blockquote><p>ì—¬ê¸°ì„œ ì£¼ëª©í•´ì•¼ í•  ë¶€ë¶„ì€ <code>--metrics-bind-address=:8080</code> ë¶€ë¶„ì…ë‹ˆë‹¤.
ì•ì„œ ë§í–ˆë“¯ì´ kubebuilderëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ë©”íŠ¸ë¦­ ì„œë²„ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì™¸ë¶€ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ <code>:8080(http)</code> ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Release.Name }}-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;helm.sh/hook-weight&#34;: </span><span class=s2>&#34;0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>challenge-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>challenge-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>nodeSelector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hexactf/env</span><span class=p>:</span><span class=w> </span><span class=l>mgmt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>serviceAccountName</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Release.Name }}-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Values.operator.image.repository }}:{{ .Values.operator.image.tag }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Values.operator.image.pullPolicy }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=c># Add the args section here</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c># Use --metrics-bind-address and substitute the environment variable METRICS_ADDR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=s2>&#34;--metrics-bind-address=:8080&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=servicemonitor-ì„¤ì •í•˜ê¸°>ServiceMonitor ì„¤ì •í•˜ê¸°</h3><p>Prometheus ServiceMonitorëŠ” ì°¨ë¡€ë¡œ í•´ë‹¹ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ê²€ìƒ‰í•˜ê³  íŒŒë“œë¥¼ ëª¨ë‹ˆí„°ë§í•˜ë„ë¡ í”„ë¡œë©”í…Œìš°ìŠ¤ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. ì–´ë–¤ ì—”ë“œí¬ì¸íŠ¸ì˜ ì–´ë–¤ í¬íŠ¸ë¥¼ í†µí•´ ë©”íŠ¸ë¦­ì„ ìŠ¤í¬ë˜í•‘í•˜ê³  ì–´ë–¤ ë§¤ê°œë³€ìˆ˜ë¥¼ í™œìš©í• ì§€ êµ¬ì„±í•˜ê²Œ ë©ë‹ˆë‹¤. ì‰½ê²Œ ë§í•´ <strong>ê²€ìƒ‰ ëŒ€ìƒì„ Prometheus Operatorê°€ ì¼ê´„ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ServiceMonitorë¼ëŠ” ë¦¬ì†ŒìŠ¤ì— ì •ì˜í•œ ê²ƒì…ë‹ˆë‹¤.</strong></p><p>Operatorì— ë©”íŠ¸ë¦­ ì„œë²„ì˜ í¬íŠ¸ë¥¼ ì—´ì—ˆë‹¤ë©´ Helmì—ì„œ Portë¥¼ ì—´ì–´ì£¼ê³ , Portë¥¼ ì—°ê²°í•´ì¤€ ServiceMonitorê°€ í•„ìš”í•˜ê² ì£ ?</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Release.Name }}-operator-metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>hexactf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/name</span><span class=p>:</span><span class=w> </span><span class=l>challenge-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/instance</span><span class=p>:</span><span class=w> </span><span class=l>challenge-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/component</span><span class=p>:</span><span class=w> </span><span class=l>metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>challenge-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>operator-metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>monitoring.coreos.com/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ServiceMonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Release.Name }}-operator-monitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>monitoring </span><span class=w> </span><span class=c># Prometheus Operatorê°€ ì„¤ì¹˜ëœ ns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>release</span><span class=p>:</span><span class=w> </span><span class=l>prometheus </span><span class=w> </span><span class=c># Prometheus Operatorì˜ label select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w> </span><span class=c># Challenge Operator service matchlabel</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app.kubernetes.io/name</span><span class=p>:</span><span class=w> </span><span class=l>challenge-operator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app.kubernetes.io/component</span><span class=p>:</span><span class=w> </span><span class=l>metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespaceSelector</span><span class=p>:</span><span class=w> </span><span class=c># ìŠ¤í¬ë©í•  ns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchNames</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>hexactf</span><span class=w> </span><span class=c># Challenge Operatorê°€ ë°°í¬ë˜ëŠ” ns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=l>operator-metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>30s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrapeTimeout</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scheme</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>í”„ë¡œë©”í…Œìš°ìŠ¤ë¥¼ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì„œë¹„ìŠ¤ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image-2.png width=1007 height=292 srcset="/p/hexactf-9/image-2_hu_fc9af273d105a8c.png 480w, /p/hexactf-9/image-2_hu_141a1be2abc2d49b.png 1024w" loading=lazy alt="í”„ë¡œë©”í…Œìš°ìŠ¤ ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸í•œ Challenge Operator metrics endpoint" class=gallery-image data-flex-grow=344 data-flex-basis=827px></p><h2 id=ì‹œê°í™”>ì‹œê°í™”</h2><p>ì €í¬ê°€ ì‹œê°í™” í•  ëª©ë¡ì€ í¬ê²Œ 3ê°€ì§€ì…ë‹ˆë‹¤.</p><ul><li>ìƒíƒœë³„ Challenge ê°œìˆ˜</li><li><strong>ì‚¬ìš©ì, ë¬¸ì œ ë³„</strong> Challenge ìƒíƒœ</li><li>ë¬¸ì œë³„ ì‹¤í–‰ ì¤‘/ì—ëŸ¬ ì»¤ìŠ¤í…€ ë¦¬ì†ŒìŠ¤ ìˆ˜</li></ul><p><img src=/p/hexactf-9/image-3.png width=1584 height=711 srcset="/p/hexactf-9/image-3_hu_424f59dbe6f2d08c.png 480w, /p/hexactf-9/image-3_hu_77e8732e558b4689.png 1024w" loading=lazy alt="ì‹¤ì œ ëŒ€íšŒì—ì„œ ì‚¬ìš©í•œ ëŒ€ì‹œë³´ë“œ" class=gallery-image data-flex-grow=222 data-flex-basis=534px></p><p>ì €ëŠ” ê·¸ ì¤‘ ìƒíƒœë³„ Challenge ê°œìˆ˜ì™€ ì‚¬ìš©ì, ë¬¸ì œ ë³„ Challenge ìƒíƒœë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p><blockquote><p>ìì„¸í•œ ì‚¬í•­ì€ <a class=link href=https://grafana.com/docs/grafana/latest/panels-visualizations/query-transform-data/transform-data/ target=_blank rel=noopener>Grafana ê³µì‹ ë¬¸ì„œ</a>ë¥¼ ì°¸ê³ í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.
ì°¸ê³ ë¡œ ì €ëŠ” í•˜ë‚˜í•˜ë‚˜ì”© ë‹¤ í•´ë´¤ìŠµë‹ˆë‹¤. ğŸ¥¹</p></blockquote><h3 id=ìƒíƒœë³„-challenge-ê°œìˆ˜>ìƒíƒœë³„ Challenge ê°œìˆ˜</h3><p>2ì‹œê°„ ë™ì•ˆ ê°€ì¥ ë§ˆì§€ë§‰ ê°’ì´ 1(Running)ì¸ ê²½ìš°ë¥¼ count í•´ì£¼ëŠ” ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</p><blockquote><p>2ì‹œê°„ì€ ì„ì˜ì˜ ìˆ«ìë¡œ ì‹¤ì œ ëŒ€íšŒì—ì„œëŠ” 6ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ì§‘ê³„í–ˆìŠµë‹ˆë‹¤.</p></blockquote><p><img src=/p/hexactf-9/image-4.png width=762 height=380 srcset="/p/hexactf-9/image-4_hu_cd8ed660c3f187e7.png 480w, /p/hexactf-9/image-4_hu_fe37b1a78922e555.png 1024w" loading=lazy alt="ìƒíƒœë³„ Challenge ê°œìˆ˜ PromQL" class=gallery-image data-flex-grow=200 data-flex-basis=481px></p><p>í•˜ë‚˜ì˜ íŒ¨ë„ì— 2ê°œ ì´ìƒ ë©”íŠ¸ë¦­ì„ ì„¤ì •í•˜ê²Œ ë˜ë©´ Valueì— ì•ŒíŒŒë²³ì´ ë¶™ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ë§¨ ì•„ë˜ Overrideë¥¼ í™œìš©í•˜ì—¬ ì„ì˜ë¡œ ì •í•´ì§„ ê°’ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.
ë” ë‚˜ì€ ì‹œê°í™”ë¥¼ ìœ„í•´ Color schemeì„ í†µí•´ ìƒ‰ë„ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image-5.png width=354 height=586 srcset="/p/hexactf-9/image-5_hu_2586051c7b8f12f3.png 480w, /p/hexactf-9/image-5_hu_ca6eeda7c0e80c03.png 1024w" loading=lazy alt="Overrideë¥¼ í™œìš©í•˜ì—¬ field nameê³¼ ìƒ‰ ì„¤ì •" class=gallery-image data-flex-grow=60 data-flex-basis=144px></p><p>ê·¸ë¦¬ê³  ì„¤ì •í•œ ìƒ‰ì„ Backgroundì— ë³´ì¼ ìˆ˜ ìˆë„ë¡ Stat stylesì— ì„¤ì •í–ˆìŠµë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image-6.png width=353 height=530 srcset="/p/hexactf-9/image-6_hu_e21a7d6750258aab.png 480w, /p/hexactf-9/image-6_hu_dc53968c972a7bc.png 1024w" loading=lazy alt="Stat styles ì„¤ì •" class=gallery-image data-flex-grow=66 data-flex-basis=159px></p><p>ì•„ë˜ì™€ ê°™ì´ ì‹œê°í™”ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image-7.png width=1129 height=249 srcset="/p/hexactf-9/image-7_hu_219bfae10535345.png 480w, /p/hexactf-9/image-7_hu_923395d241e9dc6f.png 1024w" loading=lazy alt="ìƒíƒœë³„ Challenge ê°œìˆ˜ ìµœì¢…" class=gallery-image data-flex-grow=453 data-flex-basis=1088px></p><h3 id=ì‚¬ìš©ì-ë¬¸ì œ-ë³„-challenge-ìƒíƒœ>ì‚¬ìš©ì, ë¬¸ì œ ë³„ Challenge ìƒíƒœ</h3><p>ìœ„ì™€ ë™ì¼í•˜ê²Œ ìµœê·¼ ìƒíƒœ ì •ë³´ë§Œ ê°€ì ¸ì˜¤ë©´ ë˜ê¸° ë•Œë¬¸ì— ì§‘ê³„ ì‹œê°„ ì¤‘ ê°€ì¥ ìµœì‹ ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>last_over_time(challenge_resource_status[2h])
</span></span></code></pre></td></tr></table></div></div><p>GaugeëŠ” ìˆ«ìë¡œ ê°’ì„ ì„¤ì •í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ Value mappingsë¥¼ í™œìš©í•˜ì—¬ ë¬¸ìë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image-8.png width=349 height=200 srcset="/p/hexactf-9/image-8_hu_764c9c7424de2d57.png 480w, /p/hexactf-9/image-8_hu_ef63f2cb567cfd98.png 1024w" loading=lazy alt="value mapping" class=gallery-image data-flex-grow=174 data-flex-basis=418px></p><p>PromQLì€ ì‰¬ìš´ ëŒ€ì‹  Transformì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p><ol><li>Oragnaize field by name : challenge_id, username, status ê°’ì„ ì œì™¸í•˜ê³  ì „ë¶€ ì œê±°í•©ë‹ˆë‹¤.</li><li>Group by: Challenge_id, usernameì„ ê·¸ë£¹í•‘í•˜ì—¬ ì¤‘ë³µì„ ì—†ì• ê³  StatusëŠ” ê°€ì¥ ìµœì‹  ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.</li><li>Grouping to Matrix: Groupingí•œ ê°’ì„ ê°€ì§€ê³  ìƒˆë¡œìš´ Matrixë¥¼ í™œìš©í•©ë‹ˆë‹¤.</li></ol><p><img src=/p/hexactf-9/image-9.png width=927 height=304 srcset="/p/hexactf-9/image-9_hu_b4556438ba351c9e.png 480w, /p/hexactf-9/image-9_hu_6d345ca5c16779c1.png 1024w" loading=lazy alt="ì‚¬ìš©ì, ë¬¸ì œ ë³„ Challenge ìƒíƒœ-Transform" class=gallery-image data-flex-grow=304 data-flex-basis=731px></p><p>í…Œì´ë¸” í˜•íƒœë¡œ ì‹œê°í™” í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img src=/p/hexactf-9/image-10.png width=1106 height=115 srcset="/p/hexactf-9/image-10_hu_663245b90d615f75.png 480w, /p/hexactf-9/image-10_hu_923ae2d9817a3952.png 1024w" loading=lazy alt="ì‚¬ìš©ì, ë¬¸ì œ ë³„ Challenge ìƒíƒœ-ìµœì¢…" class=gallery-image data-flex-grow=961 data-flex-basis=2308px></p><h2 id=ë§ˆì¹˜ë©°>ë§ˆì¹˜ë©°</h2><p>Challenge Operatorì™€ ê´€ë ¨ëœ ê¸€ì„ ëª¨ë‘ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p><p>ë‹¤ìŒ ê¸€ì—ì„œëŠ” ì‹¤ì§ˆì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ì„ ë³´ë‚´ëŠ” Challenge Control APIì— ëŒ€í•´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p><h2 id=references>References</h2><ul><li><a class=link href=https://wlsdn3004.tistory.com/35 target=_blank rel=noopener>Prometheus ë€?</a></li><li><a class=link href=https://prometheus.io/docs/concepts/metric_types/ target=_blank rel=noopener>Metric types | Prometheus</a></li><li><a class=link href=https://www.gomgomshrimp.com/posts/k8s/helm-and-kustomize target=_blank rel=noopener>Helmê³¼ Kustomize, ë¬´ì—‡ì„ ì“¸ê¹Œ?</a></li><li><a class=link href=https://grafana.com/docs/grafana/latest/panels-visualizations/query-transform-data/transform-data/ target=_blank rel=noopener>Transform data | Grafana documentation</a></li><li>ì •í˜„ì„, ì§„ë¯¸ë€ . (2023). ëª¨ë‹ˆí„°ë§ì˜ ìƒˆë¡œìš´ ë¯¸ë˜ ê´€ì¸¡ ê°€ëŠ¥ì„±. ì œì´í.</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/kubernetes/>Kubernetes</a>
<a href=/tags/prometheus/>Prometheus</a>
<a href=/tags/grafana/>Grafana</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/hexactf-10/><div class=article-details><h2 class=article-title>HexaCTF 10. ì•„í‚¤í…ì³ ì„¤ê³„ ë° Challenge Control API ì œì‘</h2></div></a></article><article><a href=/p/hexactf-8/><div class=article-details><h2 class=article-title>HexaCTF 8. ì»¤ìŠ¤í…€ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í†µí•œ Challenge ìƒì„± ë° ì‚­ì œ êµ¬í˜„</h2></div></a></article><article><a href=/p/hexactf2025-review/><div class=article-details><h2 class=article-title>HexaCTF2025 ëŒ€íšŒ ìš´ì˜ í›„ê¸°</h2></div></a></article><article><a href=/p/hexactf-7/><div class=article-details><h2 class=article-title>HexaCTF 7. Challenge CR ìƒíƒœ ì •ì˜ì™€ Operator ê°œë… ì •ë¦¬</h2></div></a></article><article><a href=/p/hexactf-6/><div class=article-details><h2 class=article-title>HexaCTF 6. Kubebuilderë¥¼ í™œìš©í•œ ChallengeDefinition&amp;Challenge Type êµ¬í˜„</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 -
2025 S0okJu.dev</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>