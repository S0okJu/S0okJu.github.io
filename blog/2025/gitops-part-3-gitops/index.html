<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h3>GitOps</h3> <h4>개념</h4> <p>GitOps란 DevOps의 적용하는 실천 방법 중 하나로 클라우드 네이티브 애플리케이션을 대상으로 한 지속적인 배포에 초점을 맞추고 있습니다. 이름에서 나타나듯이 배포와 운영에 관련된 모든 요소를 Git으로 관리하는 것에 초점이 맞춰져 있습니다. <br>GitOps는 배포와 관련된 모든 것을 선언형 기술 형태로 작성하여 이러한 파일들을 레포지토리 형태로 관리합니다. 그리고 선언형 기술서와 운영 환경 간 상태 차이가 없도록 유지시켜주는 자동화 시스템을 구성합니다.</p> <h4>DevOps vs GitOps</h4> <p>DevOps는 개발과 운영의 합성어로 소프트웨어 개발과 IT 운영 팀 간의 협업을 강화하여 지속적인 통합과 배포를 가능하게 하는 문화 및 철학을 의미합니다. <br>앞서 GitOps는 DevOps의 문화 중 클라우드 네이티브 환경에 가장 적합한 방법론이라고 보시면 됩니다.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*G8m6QlAaHXvD5GYY8wKOIw.png"><figcaption>출처 — <a href="https://www.techtarget.com/searchitoperations/tip/Compare-GitOps-vs-DevOps-for-modern-app-deployments" rel="external nofollow noopener" target="_blank">https://www.techtarget.com/searchitoperations/tip/Compare-GitOps-vs-DevOps-for-modern-app-deployments</a></figcaption></figure> <p>DevOps의 주요 원칙은 아래와 같습니다.</p> <ul> <li>지속적인 통합(CI)</li> <li>지속적인 배포(CD)</li> <li>자동화 및 모니터링</li> <li>협업과 소통</li> </ul> <p>프로젝트와 함께 설명할때는 <strong>지속적인 통합과 지속적인 배포를 중심</strong>으로 설명하겠습니다.</p> <h3>GitOps 파이프라인 계획 세우기</h3> <h4>GitOps를 선택한 이유</h4> <p>GitOps는 클라우드 네이티브 환경 특히 쿠버네티스에 적합한 방법론입니다.</p> <blockquote>클라우드 네이티브 애플리케이션이 아니어도 깃옵스를 적용할 수 있으나 아래에서 설명드릴 <strong>선언형 모델(Declarative Model)을 지원하는 최근 도구들이 클라우드 네이티브에 중점</strong>을 두기 때문에 어려움을 겪을 수 있습니다. <strong>위브웍스는 아예 쿠버네티스 대상</strong>이라고 못박고 있습니다.<br>출처 — <a href="https://www.samsungsds.com/kr/insights/gitops.html" rel="external nofollow noopener" target="_blank">데브옵스의 확장 모델 — 깃옵스(GitOps) 이해하기 | 인사이트리포트 | 삼성SDS</a> </blockquote> <p>저는 현재 쿠버네티스 환경에서 시스템을 운영하고 있습니다. 그러므로 <strong>쿠버네티스 환경에 가장 적합한 자동화 통합과 배포를 수행하고 싶어 선택</strong>하게 되었습니다.</p> <h4>필요 항목</h4> <p>프로젝트에 적용하기 전에 필요한 항목은 아래와 같습니다.<br>1. 프로젝트 GitHub <br>2. 컨테이너 이미지를 만드는 CI 파이프라인<br>3. 컨테이너 이미지 저장소<br>4. 쿠버네티스 매니페스트(Manifest) 저장소<br>5. Manifest를 클러스터에 동기화하고 변화를 감지하는 GitOps 엔진</p> <h4>설계하기</h4> <p><strong>Manifest 저장소</strong><br>프로젝트에서 3개의 레포지토리를 관리하고 있습니다. <br>그러나 Manifest 저장소는 하나로 관리하는 것이 편리하다고 판단하여 <strong>프로젝트명으로 폴더를 분리하여 Kustomize 코드를 저장</strong>했습니다.</p> <p><strong>CI/CD 도구</strong><br>CI/CD 도구는 <strong>쿠버네티스 클러스터 내부에서 동작해야 한다는 기준을 가지고 선정</strong>했습니다. 컨테이너 레지스트리(Harbor), 배포할 대상 모두 쿠버네티스 내부에서 동작하기 때문입니다. 이러한 기준점을 가지고 클라우드 네이티브 CI/CD 도구인 <a href="https://tekton.dev/" rel="external nofollow noopener" target="_blank">Tekton</a>, <a href="https://argo-cd.readthedocs.io/en/stable/" rel="external nofollow noopener" target="_blank">ArgoCD</a>를 선택하게 되었습니다. <br>Tekton이 GitHub Webhook을 통해 main 브랜치의 변경 이벤트에 맞춰 자동으로 이미지 빌드를 수행합니다. 생성한 이미지의 해시값을 Manifest 저장소에 업데이트를 수행합니다. <br>ArgoCD가 Manifest 저장소의 주기적으로 변경사항을 감지합니다. 변경 사항이 감지되면 Manifest 저장소에 맞춰 동기화를 수행합니다.</p> <p><strong>Slack Notifications</strong><br>더 나아가 지속적인 통합(CI)과 배포의 실행 상태(CD)를 파악하기 위해 슬랙 채널에 메세지를 보낼 수 있도록 설계했습니다. 이를 통해 프로젝트 팀원이 CI/CD 실행 현황을 파악할 수 있도록 설정합니다.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/831/1*J7owwscpwWS-IWITaZNxCw.png"><figcaption>설계도</figcaption></figure> <h3>다음 이야기</h3> <p>다음 글에서는 Tekton을 활용하여 어떻게 CI를 구성했는지 설명합니다.</p> <h3>Refereneces</h3> <ul> <li><a href="https://www.samsungsds.com/kr/insights/gitops.html" rel="external nofollow noopener" target="_blank">https://www.samsungsds.com/kr/insights/gitops.html</a></li> <li><a href="https://tech.ktcloud.com/entry/What-is-DevOps-DevOps-CICD" rel="external nofollow noopener" target="_blank">What is DevOps? — DevOps &amp; CI/CD</a></li> </ul> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=4af79e4ed80f" width="1" height="1" alt="">&lt;hr&gt;&lt;p&gt;<a href="https://medium.com/s0okju-tech/gitops-%EC%A0%84%ED%99%98%EA%B8%B0-3-gitops-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8-%EA%B3%84%ED%9A%8D-%EC%84%B8%EC%9A%B0%EA%B8%B0-4af79e4ed80f" rel="external nofollow noopener" target="_blank">GitOps 전환기 - Part 3. GitOps 파이프라인 계획 세우기</a> was originally published in <a href="https://medium.com/s0okju-tech" rel="external nofollow noopener" target="_blank">S0okJu Technology Blog</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;</p> </body></html>